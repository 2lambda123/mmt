<% options.delete(:title) %>
<div class="row sub-fields">
  <label for="<%= remove_pipes(name_prefix) %>role" class="icon-required">Role</label><i class="fa fa-info-circle"></i>
  <%= select_tag name_to_param("#{name_prefix}role"), options_for_select([['Select Role', ''],['Resource Provider', 'RESOURCEPROVIDER'], ['Custodian', 'CUSTODIAN'], ['Owner', 'OWNER'], ['User', 'USER'], ['Distributor', 'DISTRIBUTOR'], ['Originator', 'ORIGINATOR'], ['Point of Contact', 'POINTOFCONTACT'], ['Principal Investigator', 'PRINCIPALINVESTIGATOR'], ['Processor', 'PROCESSOR'], ['Publisher', 'PUBLISHER'], ['Author', 'AUTHOR'], ['Sponsor', 'SPONSOR'], ['Co-Author', 'COAUTHOR'], ['Collaborator', 'COLLABORATOR'], ['Editor', 'EDITOR'], ['Mediator', 'MEDIATOR'], ['Rights Holder', 'RIGHTSHOLDER'], ['Contributor', 'CONTRIBUTOR'], ['Funder', 'FUNDER'], ['Stakeholder', 'STAKEHOLDER']], responsibility['Role']), class: 'single-select' %>

  <% party = responsibility['Party'] || {} %>
  <!-- Person or Org radio buttons -->
  <!-- No name attribute to keep from submitting params, javascript will handle radio button group behavior -->
  <% person_checked = !party['Person'].nil? %>
  <% organization_checked = !party['OrganizationName'].nil? %>
  <div class="party-type" style="<%= 'display: none;' if options[:limit_type] %>">
    <input type="radio" id="<%= remove_pipes(name_prefix) %>responsibility_organization" value="organization" class="responsibility-picker organization" <%= 'checked="checked"' if organization_checked || options[:limit_type] == 'organization' %>>
    <label for="<%= remove_pipes(name_prefix) %>responsibility_organization">Organization</label>
    <input type="radio" id="<%= remove_pipes(name_prefix) %>responsibility_person" value="person" class="responsibility-picker person" <%= 'checked="checked"' if person_checked || options[:limit_type] == 'personnel' %>>
    <label for="<%= remove_pipes(name_prefix) %>responsibility_person">Person</label>
  </div>

  <!-- org fields -->
  <div class="organization-fields" style="<%= 'display: none;' if person_checked || options[:limit_type] == 'personnel' %>">
    <%= render partial: 'drafts/forms/type', locals: {
        type: 'organization_name',
        values: party['OrganizationName'] || {},
        name_prefix: "#{name_prefix}party_",
        multiple: false,
        options: options } %>
  </div>

  <!-- person fields -->
  <div class="person-fields" style="<%= 'display: none;' if organization_checked || options[:limit_type] == 'organization' %>">
    <%= render partial: 'drafts/forms/type', locals: {
        type: 'person',
        values: party['Person'] || {},
        name_prefix: "#{name_prefix}party_",
        multiple: false,
        options: options } %>
  </div>

  <!-- all party fields -->
  <label for="<%= remove_pipes(name_prefix) %>party_service_hours">Service Hours</label><i class="fa fa-info-circle"></i>
  <%= text_field_tag(name_to_param("#{name_prefix}party_|service_hours|"), party['ServiceHours'], class: 'half-width') %>

  <label for="<%= remove_pipes(name_prefix) %>party_contact_instructions">Contact Instructions</label><i class="fa fa-info-circle"></i>
  <%= text_field_tag(name_to_param("#{name_prefix}party_|contact_instructions|"), party['ContactInstructions'], class: 'half-width') %>

  <!-- Contact - multiple -->
  <%= render partial: 'drafts/forms/type', locals: {
      type: 'contact',
      values: party['Contact'] || [{}],
      name_prefix: "#{name_prefix}party_contact_",
      multiple: true,
      options: options } %>

  <!-- Address - multiple -->
  <%= render partial: 'drafts/forms/type', locals: {
      type: 'address',
      values: party['Address'] || [{}],
      name_prefix: "#{name_prefix}party_address_",
      multiple: true,
      options: options } %>

  <!-- RelatedUrl - multiple -->
  <%= render partial: 'drafts/forms/type', locals: {
      type: 'related_url',
      values: party['RelatedUrl'] || [{}],
      name_prefix: "#{name_prefix}party_|related_url|_",
      multiple: true,
      options: options } %>
</div>
