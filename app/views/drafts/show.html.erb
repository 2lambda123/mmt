<main class="internal record">
  <header>
    <div class="content">
      <div class="breadcrumb">
        <ol>
          <li><%= link_to 'Dashboard', dashboard_path %></li>
          <li><%= link_to 'Drafts', drafts_path %></li>
          <li><%= @draft.display_entry_title %></li>
        </ol>
      </div>
      <h2><%= @draft.display_entry_title %></h2>
      <p class="subtitle current">Draft Record</p>
    </div>
  </header>

  <%= render 'shared/flash_messages' %>

  <div class="row row-content">
    <section class="action">
      <div class="cta">
        <%= link_to 'Publish', draft_publish_path(@draft), method: :post, class: 'btn btn-blue', alt: 'Publish Draft' %>
        <a class="download-xml-link" href="#download-xml-modal" data-path="<%= draft_download_path(@draft) %>" alt="Download XML">Download XML</a> |
        <%= link_to 'Delete Draft', "/drafts/#{@draft.id}", method: :delete, data: { confirm: 'Are you sure you want to delete this record?' } %>
      </div>
      <div class="quality-score disabled">
        <div class="badges">
          <i class="fa fa-star fa-lg"></i>
          <i class="fa fa-star fa-lg"></i>
          <i class="fa fa-star fa-lg"></i>
          <i class="fa fa-star fa-lg"></i>
          <i class="fa fa-star-o fa-lg"></i>
        </div>
        <div class="score-info">
          <p>Quality Score: <strong>20</strong></p>
          <p>Required fields not complete</p>
        </div>
      </div>

      <%= render partial: 'shared/download_xml', locals: { collection: false } %>
    </section>

    <% if @errors && !@errors.empty? %>
      <section class="errors">
        <div class="banner banner-danger">
          <i class="fa fa-exclamation-triangle"></i> This draft has the following errors:
          <ul class="no-bullet">
            <% @errors.each do |error| %>
              <li>
                <%= link_to "#{name_to_title(error[:field])} #{error[:error]}", draft_edit_form_path(@draft, error[:page]) if error[:field] && error[:page] %>
              </li>
            <% end %>
          </ul>
        </div>
      </section>
    <% end %>

    <%= render partial: 'drafts/progress/preview_progress', locals: { draft: @draft, metadata_errors: @errors } %>

    <%= render partial: 'shared/preview/metadata_preview', locals: { metadata: @draft.draft } %>

  </div>
</main>
