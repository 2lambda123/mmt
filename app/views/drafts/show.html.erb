<main class="internal record">
  <header>
    <div class="content">
      <div class="breadcrumb">
        <ol>
          <li><%= link_to 'Manage Metadata Dashboard', dashboard_path %></li>
          <li><%= link_to @draft.display_entry_title, draft_path(@draft) %></li>
        </ol>
      </div>
      <h2><%= @draft.display_entry_title %></h2>
      <p class="subtitle">Draft Record</p>
    </div>
  </header>
  <div class="row row-content">
    <section class="action">
      <div class="cta">
        <a href="#" alt="Publish Button" class="btn btn-blue">Publish</a>
        <a href="#" alt="Download XML">Download XML</a> |
        <%= link_to 'Delete Draft', @draft, method: :delete, data: { confirm: 'Are you sure you want to delete this record?' } %>
      </div>
      <div class="quality-score">
        <div class="badges">
          <i class="fa fa-star fa-lg"></i>
          <i class="fa fa-star fa-lg"></i>
          <i class="fa fa-star fa-lg"></i>
          <i class="fa fa-star fa-lg"></i>
          <i class="fa fa-star-o fa-lg"></i>
        </div>
        <div class="score-info">
          <p>Quality Score: <strong>20</strong></p>
          <p>Required fields not complete</p>
        </div>
      </div>
    </section>
    <section class="metadata">
      <h3>Metadata Fields</h3>
      <ul>
        <li>
          <div class="status">
            <i class="fa fa-circle-thin"></i>
          </div>
          <div class="meta-info">
            <%= link_to 'Data Identification', draft_edit_form_path(@draft, 'data_identification') %>
            <br>
            <i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o icon-grey"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i>
          </div>
        </li>
        <li>
          <div class="status">
            <i class="fa fa-circle-thin"></i>
          </div>
          <div class="meta-info">
            <%= link_to 'Descriptive Keywords', draft_edit_form_path(@draft, 'descriptive_keywords') %>
            <br>
            <i class="fa fa-circle icon-grey"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o icon-grey"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i>
          </div>
        </li>
        <li>
          <div class="status">
            <i class="fa fa-circle-thin"></i>
          </div>
          <div class="meta-info">
            <%= link_to 'Metadata Information', draft_edit_form_path(@draft, 'metadata_information') %>
            <br>
            <i class="fa fa-circle"></i><i class="fa fa-circle-o icon-grey"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o icon-grey"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i>
          </div>
        </li>
        <li>
          <div class="status">
            <i class="fa fa-check-circle"></i>
          </div>
          <div class="meta-info">
            <%= link_to 'Temporal Extent', draft_edit_form_path(@draft, 'temporal_extent') %>
            <br>
            <i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o icon-grey"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i>
          </div>
        </li>
        <li>
          <div class="status">
            <i class="fa fa-circle-thin"></i>
          </div>
          <div class="meta-info">
            <%= link_to 'Spatial Extent', draft_edit_form_path(@draft, 'spatial_extent') %>
            <br>
            <i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o icon-grey"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle icon-grey"></i><i class="fa fa-circle-o icon-grey"></i>
          </div>
        </li>
        <li>
          <div class="status">
            <i class="fa fa-circle-thin"></i>
          </div>
          <div class="meta-info">
            <%= link_to 'Acquisition Information', draft_edit_form_path(@draft, 'acquisition_information') %>
            <br>
            <i class="fa fa-circle"></i><i class="fa fa-circle-o icon-grey"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle- icon-grey"></i>
          </div>
        </li>
        <li>
          <div class="status">
            <i class="fa fa-check-circle"></i>
          </div>
          <div class="meta-info">
            <%= link_to 'Distribution Information', draft_edit_form_path(@draft, 'distribution_information') %>
            <br>
            <i class="fa fa-circle icon-grey"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o icon-grey"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i><i class="fa fa-circle"></i><i class="fa fa-circle-o"></i>
          </div>
        </li>
      </ul>
    </section>

    <div class="row content">
      <section class="preview">

        <h3>Preview</h3>
        <p>
          <input type="checkbox" name="markdown"></input>
          <label for="markdown">Show as markdown</label>
        </p>

      <%= render :partial=>'drafts/previews/data_identification', :locals=>{:draft=>@draft.draft} %>
      <%= render :partial=>'drafts/previews/descriptive_keywords', :locals=>{:draft=>@draft.draft} %>
      <%= render :partial=>'drafts/previews/metadata_information', :locals=>{:draft=>@draft.draft} %>
      <%= render :partial=>'drafts/previews/temporal_extent', :locals=>{draft: @draft.draft} %>
      <%= render :partial=>'drafts/previews/spatial_extent', :locals=>{draft: @draft.draft} %>
      <%= render :partial=>'drafts/previews/acquisition_information', :locals=>{:draft=>@draft.draft} %>
      <%= render :partial=>'drafts/previews/distribution_information', :locals=>{:draft=>@draft.draft} %>

    </section>
    <aside class="geographic-coverage">
      <h3>Geographic Coverage</h3>
      <%= image_tag("plate_carree_earth@2x.png", alt:'Map', id:'preview_map') %>

      <caption>Spatial Coordinates</caption>
      <ol class="coordinates" id="coordinates"></ol>

      <h4>Location Keywords</h4>
      <ul>
        <li>Continent > Antartica</li>
        <li>Geographic Region > Polar</li>
      </ul>

      <h4>Temporal Coverage</h4>
      <ul>

        <% @single_date_times.each do |single_date_time| %>
          <li>Date: <%= single_date_time %></li></br>
        <% end %>

        <% @range_date_times.each do |range_date_time| %>
          <li>Start Date: <%= range_date_time['beginning_date_time']%> </li> <li>Stop Date: <%= range_date_time['ending_date_time']%> </li></br>
        <% end %>

        <% @periodic_date_times.each do |periodic_date_time| %>
          <li>Start Date: <%= periodic_date_time['start_date']%> </li> <li>Stop Date: <%= periodic_date_time['end_date']%> </li></br>
        <% end %>

        <% if @single_date_times.blank? && @range_date_times.blank? && @periodic_date_times.blank? %>
          <li>No Temporal Coverages found</li>
        <% end %>

      </ul>
    </aside>

  </div>

  <script>
    var map_position = $('#preview_map').offset();
    var map_x1 = map_position.left;
    var map_y1 = map_position.top;

    var highlight_color = "rgba(250,0,0,0.25)"
    var dot_size = 5;

    <% @point_coordinate_array.each do |point| %>
      draw_point(<%=point['x']%> + map_x1, <%=point['y']%> + map_y1, dot_size, highlight_color);
      document.getElementById("coordinates").innerHTML += "<li>Lat: <%= point['lat'] %></li> <li>Lon: <%= point['lon'] %></li></br>";  // TODO - UI dev - remove </br>
    <% end %>

    <% @rectangle_coordinate_array.each do |rectangle| %>
      draw_rectangle( <%=rectangle['min_x']%> + map_x1, <%=rectangle['min_y']%> + map_y1, <%=rectangle['max_x']%> + map_x1, <%=rectangle['max_y']%> + map_y1, highlight_color );
      document.getElementById("coordinates").innerHTML +="<li>N: <%=rectangle['nbc']%></li> \
                                                          <li>S: <%=rectangle['sbc']%></li> \
                                                          <li>E: <%=rectangle['ebc']%></li> \
                                                          <li>W: <%=rectangle['wbc']%></li></br>"; // TODO - UI dev - remove </br>
    <% end %>

    <% if @point_coordinate_array.blank? && @rectangle_coordinate_array.blank? %>
      document.getElementById("coordinates").innerHTML = "<li>No Spatial Coordinates found</li>";
    <% end %>

  </script>


</main>
